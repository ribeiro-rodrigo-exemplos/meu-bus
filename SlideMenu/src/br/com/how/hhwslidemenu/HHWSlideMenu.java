package br.com.how.hhwslidemenu;import java.util.ArrayList;import java.util.List;import android.app.Activity;import android.content.Context;import android.content.Intent;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentActivity;import android.support.v4.app.FragmentManager;import android.support.v4.app.FragmentTransaction;import android.support.v4.view.GravityCompat;import android.support.v4.widget.DrawerLayout;import android.support.v7.app.ActionBarDrawerToggle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ArrayAdapter;import android.widget.ImageView;import android.widget.ListView;import android.widget.RelativeLayout;import android.widget.TextView;public class HHWSlideMenu {	public final int STARTPAGE = 0;	private List<HHWMenuItem> menuItemsObjects;	Activity activity;	public DrawerLayout mDrawerLayout;	ListView mDrawerList;	RelativeLayout mDrawerContent;	public ActionBarDrawerToggle mDrawerToggle;	public HHWSlideMenu(Activity activity, ArrayList<HHWMenuItem> items) {		this.activity = activity;		mDrawerLayout = (DrawerLayout) activity				.findViewById(R.id.hhw_menu_drawer_layout);		mDrawerList = (ListView) activity.findViewById(R.id.hhw_menu_left_drawer);		mDrawerLayout.setDrawerShadow(R.drawable.hhw_drawer_shadow,				GravityCompat.START);		mDrawerContent = (RelativeLayout) activity				.findViewById(R.id.hhw_menu_drawer_content);		setMenuItemsObjects(items);		setIconMenu();	}	public void setMenuItemsObjects(ArrayList<HHWMenuItem> items) {		menuItemsObjects = new ArrayList<HHWMenuItem>();		menuItemsObjects = items;		MenuAdapter adapter = new MenuAdapter(activity, menuItemsObjects);		mDrawerList.setAdapter(adapter);	}	public void openItemMenu(int position) {		FragmentManager fm = ((FragmentActivity) activity)				.getSupportFragmentManager();		FragmentTransaction ft = fm.beginTransaction();		if (position != STARTPAGE) {			ft.addToBackStack(null);		}		HHWMenuItem item = menuItemsObjects.get(position);		if (item.isFragment) {			mDrawerLayout.closeDrawers();			ft.replace(R.id.hhw_menu_content_frame, item.fragmentClass).commit();		} else {			Intent intent = new Intent(activity, (Class<?>) item.activityClass);			activity.startActivity(intent);		}	}	private void setIconMenu() {		mDrawerToggle = new ActionBarDrawerToggle(activity, /* host Activity */		mDrawerLayout, /* DrawerLayout object */		R.string.hhw_menu_drawer_open, /* "open drawer" description for accessibility */		R.string.hhw_menu_drawer_close /* "close drawer" description for accessibility */		) {			/** Called when a drawer has settled in a completely closed state. */			public void onDrawerClosed(View view) {				// ((MainActivity)				// activity).getSupportActionBar().setIcon(R.drawable.ic_menu);			}			/** Called when a drawer has settled in a completely open state. */			public void onDrawerOpened(View drawerView) {				// ((MainActivity)				// activity).getSupportActionBar().setIcon(R.drawable.ic_launcher);			}		};		mDrawerLayout.setDrawerListener(mDrawerToggle);	}	public boolean isDrawerLayoutOpen() {		return mDrawerLayout.isDrawerOpen(mDrawerContent);	}	public Fragment getStartFragment() {		return menuItemsObjects.get(STARTPAGE).fragmentClass;	}	public class MenuAdapter extends ArrayAdapter<HHWMenuItem> {		private List<HHWMenuItem> menuItens;		public MenuAdapter(Context context, List<HHWMenuItem> itens) {			super(context, 0);			menuItens = itens;		}		@Override		public int getCount() {			return menuItens.size();		}		@Override		public View getView(final int position, View convertView,				ViewGroup parent) {			View v = convertView;			final CompleteListViewHolder viewHolder;			if (convertView == null) {				ViewGroup noRootView = null;				LayoutInflater li = (LayoutInflater) getContext()						.getSystemService(Context.LAYOUT_INFLATER_SERVICE);				v = li.inflate(R.layout.item_list_hhw_menu, noRootView);				viewHolder = new CompleteListViewHolder(v);				v.setTag(viewHolder);				v.setOnClickListener(new View.OnClickListener() {					@Override					public void onClick(View view) {						 CompleteListViewHolder viewCompleteListViewHolder =						 (CompleteListViewHolder) view.getTag();						openItemMenu(viewCompleteListViewHolder.pos);					}				});			} else {				viewHolder = (CompleteListViewHolder) v.getTag();			}			HHWMenuItem menuItem = menuItens.get(position);			// if (menuItem.icon == null) {			// viewHolder.icon.setVisibility(View.GONE);			// } else {			// viewHolder.icon.setImageDrawable(menuItem.icon);			// }			viewHolder.icon.setImageDrawable(menuItem.icon);			viewHolder.label.setText(menuItem.itemName);			viewHolder.pos = position;			return v;		}		class CompleteListViewHolder {			public ImageView icon;			public TextView label;			public int pos;			public CompleteListViewHolder(View base) {				icon = (ImageView) base						.findViewById(R.id.item_list_hhwslidemenu_icon);				label = (TextView) base						.findViewById(R.id.item_list_hhwslidemenu_name);			}		}	}}